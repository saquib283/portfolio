{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mdreh/Downloads/self-site/src/app/admin/%28protected%29/guestbook/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from 'react';\r\nimport useSWR from 'swr';\r\nimport { Check, Trash2, X } from 'lucide-react';\r\n\r\nconst fetcher = (url: string) => fetch(url).then(res => res.json());\r\n\r\nexport default function GuestbookAdmin() {\r\n    // Custom fetcher that fetches ALL messages for admin (need a new API param or separate route?)\r\n    // For simplicity, let's just fetch from the same route but maybe we need to filter?\r\n    // Actually, current public GET only returns approved. We need an admin GET.\r\n    // Let's modify the GET route first or just use a client fetch for now that assumes admin session? \r\n    // Wait, the API GET route I wrote filters { approved: true }. I need to change that.\r\n\r\n    // Changing approach: Let's assume I'll fix the API to return all if admin, or add ?all=true\r\n    const { data: messages, mutate } = useSWR('/api/guestbook?admin=true', fetcher);\r\n\r\n    const toggleApproval = async (id: string, currentStatus: boolean) => {\r\n        await fetch(`/api/guestbook/${id}`, {\r\n            method: 'PUT',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ approved: !currentStatus })\r\n        });\r\n        mutate();\r\n    };\r\n\r\n    const deleteMessage = async (id: string) => {\r\n        if (!confirm('Delete this message?')) return;\r\n        await fetch(`/api/guestbook/${id}`, { method: 'DELETE' });\r\n        mutate();\r\n    };\r\n\r\n    if (!messages) return <div className=\"text-secondary p-8\">Loading...</div>;\r\n\r\n    return (\r\n        <div>\r\n            <h1 className=\"text-3xl font-display text-primary mb-8\">Guestbook Moderation</h1>\r\n\r\n            <div className=\"bg-surface border border-border rounded-lg overflow-hidden\">\r\n                <table className=\"w-full text-left\">\r\n                    <thead className=\"bg-surfaceHighlight\">\r\n                        <tr>\r\n                            <th className=\"p-4 text-sm font-medium text-secondary\">Details</th>\r\n                            <th className=\"p-4 text-sm font-medium text-secondary\">Message</th>\r\n                            <th className=\"p-4 text-sm font-medium text-secondary\">Status</th>\r\n                            <th className=\"p-4 text-sm font-medium text-secondary text-right\">Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"divide-y divide-border\">\r\n                        {messages.map((msg: any) => (\r\n                            <tr key={msg._id} className=\"hover:bg-surfaceHighlight/50\">\r\n                                <td className=\"p-4\">\r\n                                    <div className=\"font-bold text-white\">{msg.name}</div>\r\n                                    <div className=\"text-xs text-secondary\">{new Date(msg.createdAt).toLocaleDateString()}</div>\r\n                                </td>\r\n                                <td className=\"p-4 text-sm text-secondary max-w-md\">\r\n                                    {msg.message}\r\n                                </td>\r\n                                <td className=\"p-4\">\r\n                                    {msg.approved ? (\r\n                                        <span className=\"px-2 py-1 rounded-full bg-green-500/10 text-green-500 text-xs border border-green-500/20\">Live</span>\r\n                                    ) : (\r\n                                        <span className=\"px-2 py-1 rounded-full bg-yellow-500/10 text-yellow-500 text-xs border border-yellow-500/20\">Pending</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-right flex justify-end gap-2\">\r\n                                    <button\r\n                                        onClick={() => toggleApproval(msg._id, msg.approved)}\r\n                                        className={`p-2 rounded hover:bg-white/10 ${msg.approved ? 'text-yellow-500' : 'text-green-500'}`}\r\n                                        title={msg.approved ? \"Unapprove\" : \"Approve\"}\r\n                                    >\r\n                                        {msg.approved ? <X size={18} /> : <Check size={18} />}\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => deleteMessage(msg._id)}\r\n                                        className=\"p-2 rounded hover:bg-white/10 text-red-500\"\r\n                                    >\r\n                                        <Trash2 size={18} />\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                        {messages.length === 0 && (\r\n                            <tr>\r\n                                <td colSpan={4} className=\"p-8 text-center text-secondary\">No messages found.</td>\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAAA;;;AAJA;;;AAMA,MAAM,UAAU,CAAC,MAAgB,MAAM,KAAK,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI;AAEjD,SAAS;;IACpB,+FAA+F;IAC/F,oFAAoF;IACpF,4EAA4E;IAC5E,mGAAmG;IACnG,qFAAqF;IAErF,4FAA4F;IAC5F,MAAM,EAAE,MAAM,QAAQ,EAAE,MAAM,EAAE,GAAG,IAAA,4KAAM,EAAC,6BAA6B;IAEvE,MAAM,iBAAiB,OAAO,IAAY;QACtC,MAAM,MAAM,CAAC,eAAe,EAAE,IAAI,EAAE;YAChC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,UAAU,CAAC;YAAc;QACpD;QACA;IACJ;IAEA,MAAM,gBAAgB,OAAO;QACzB,IAAI,CAAC,QAAQ,yBAAyB;QACtC,MAAM,MAAM,CAAC,eAAe,EAAE,IAAI,EAAE;YAAE,QAAQ;QAAS;QACvD;IACJ;IAEA,IAAI,CAAC,UAAU,qBAAO,6LAAC;QAAI,WAAU;kBAAqB;;;;;;IAE1D,qBACI,6LAAC;;0BACG,6LAAC;gBAAG,WAAU;0BAA0C;;;;;;0BAExD,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAM,WAAU;;sCACb,6LAAC;4BAAM,WAAU;sCACb,cAAA,6LAAC;;kDACG,6LAAC;wCAAG,WAAU;kDAAyC;;;;;;kDACvD,6LAAC;wCAAG,WAAU;kDAAyC;;;;;;kDACvD,6LAAC;wCAAG,WAAU;kDAAyC;;;;;;kDACvD,6LAAC;wCAAG,WAAU;kDAAoD;;;;;;;;;;;;;;;;;sCAG1E,6LAAC;4BAAM,WAAU;;gCACZ,SAAS,GAAG,CAAC,CAAC,oBACX,6LAAC;wCAAiB,WAAU;;0DACxB,6LAAC;gDAAG,WAAU;;kEACV,6LAAC;wDAAI,WAAU;kEAAwB,IAAI,IAAI;;;;;;kEAC/C,6LAAC;wDAAI,WAAU;kEAA0B,IAAI,KAAK,IAAI,SAAS,EAAE,kBAAkB;;;;;;;;;;;;0DAEvF,6LAAC;gDAAG,WAAU;0DACT,IAAI,OAAO;;;;;;0DAEhB,6LAAC;gDAAG,WAAU;0DACT,IAAI,QAAQ,iBACT,6LAAC;oDAAK,WAAU;8DAA2F;;;;;yEAE3G,6LAAC;oDAAK,WAAU;8DAA8F;;;;;;;;;;;0DAGtH,6LAAC;gDAAG,WAAU;;kEACV,6LAAC;wDACG,SAAS,IAAM,eAAe,IAAI,GAAG,EAAE,IAAI,QAAQ;wDACnD,WAAW,CAAC,8BAA8B,EAAE,IAAI,QAAQ,GAAG,oBAAoB,kBAAkB;wDACjG,OAAO,IAAI,QAAQ,GAAG,cAAc;kEAEnC,IAAI,QAAQ,iBAAG,6LAAC,oMAAC;4DAAC,MAAM;;;;;iFAAS,6LAAC,gNAAK;4DAAC,MAAM;;;;;;;;;;;kEAEnD,6LAAC;wDACG,SAAS,IAAM,cAAc,IAAI,GAAG;wDACpC,WAAU;kEAEV,cAAA,6LAAC,uNAAM;4DAAC,MAAM;;;;;;;;;;;;;;;;;;uCA3BjB,IAAI,GAAG;;;;;gCAgCnB,SAAS,MAAM,KAAK,mBACjB,6LAAC;8CACG,cAAA,6LAAC;wCAAG,SAAS;wCAAG,WAAU;kDAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ3F;GArFwB;;QAQe,4KAAM;;;KARrB"}}]
}